<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>T02 Distintos tipos de señal por defecto. | Navindoor MATLAB Toolbox</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="En esta entrada profundizaremos un poco más en la parámetro de entrada type de la clase BBSLevel. El valor de type, condiciona los valores por defecto de otros parametros opcionales. La siguiente tabl">
<meta name="keywords" content="ejemplos">
<meta property="og:type" content="article">
<meta property="og:title" content="T02 Distintos tipos de señal por defecto.">
<meta property="og:url" content="http://yoursite.com/CT03_S02_T02/index.html">
<meta property="og:site_name" content="Navindoor MATLAB Toolbox">
<meta property="og:description" content="En esta entrada profundizaremos un poco más en la parámetro de entrada type de la clase BBSLevel. El valor de type, condiciona los valores por defecto de otros parametros opcionales. La siguiente tabl">
<meta property="og:locale" content="es">
<meta property="og:image" content="http://yoursite.com/images/CT03/S02/0201.png">
<meta property="og:image" content="http://yoursite.com/images/CT03/S02/0202.png">
<meta property="og:image" content="http://yoursite.com/images/CT03/S02/0202b.png">
<meta property="og:image" content="http://yoursite.com/images/CT03/S02/0203.png">
<meta property="og:image" content="http://yoursite.com/images/CT03/S02/0203b.png">
<meta property="og:image" content="http://yoursite.com/images/CT03/S02/0204.png">
<meta property="og:image" content="http://yoursite.com/images/CT03/S02/0204b.png">
<meta property="og:updated_time" content="2018-05-04T14:29:23.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="T02 Distintos tipos de señal por defecto.">
<meta name="twitter:description" content="En esta entrada profundizaremos un poco más en la parámetro de entrada type de la clase BBSLevel. El valor de type, condiciona los valores por defecto de otros parametros opcionales. La siguiente tabl">
<meta name="twitter:image" content="http://yoursite.com/images/CT03/S02/0201.png">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Navindoor MATLAB Toolbox</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="https://github.com/joroya/navindoor">GitHub</a>
        
          <a class="main-nav-link" href="/">Download</a>
        
      </nav>
      <nav id="sub-nav">
        
        <a id="nav-search-btn" class="nav-icon" title="Buscar"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-CT03/S02/02" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/CT03_S02_T02/" class="article-date">
  <time datetime="2018-05-04T11:05:02.000Z" itemprop="datePublished">2018-05-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CT03-Simulacion-de-senales/">CT03 Simulación de señales</a>►<a class="article-category-link" href="/categories/CT03-Simulacion-de-senales/S02-Clase-BBSLevel/">S02 Clase BBSLevel</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      T02 Distintos tipos de señal por defecto.
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>En esta entrada profundizaremos un poco más en la parámetro de entrada <em>type</em> de la clase BBSLevel. El valor de <em>type</em>, condiciona los valores por defecto de otros parametros opcionales. La siguiente tabla resumen las cuasisticas posibles.</p>
<table>
<thead>
<tr>
<th>type</th>
<th><em>sgn_function</em>. valor por defecto</th>
<th><em>parameters_sgn</em>. valor por defecto</th>
</tr>
</thead>
<tbody>
<tr>
<td>RSS</td>
<td>@RSS_dflt</td>
<td>[0.1]</td>
</tr>
<tr>
<td>AoA</td>
<td>@AoA_dflt</td>
<td>[0.1]</td>
</tr>
<tr>
<td>ToF</td>
<td>@ToF_dflt</td>
<td>[0.1]</td>
</tr>
</tbody>
</table>
<p>Antes de empezar a generar señales crearemos una planta y una trayectoria, como elementos básicos apartir de los cuales construiremos las distintas señales.</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">clf;clear</span><br><span class="line">ilevel = level;</span><br><span class="line"><span class="comment">% generamos beacons aleatorios dentro del nivel</span></span><br><span class="line">beacons = arrayfun(@(x) <span class="built_in">rand</span>(ilevel,<span class="string">'beacon'</span>),<span class="number">1</span>:<span class="number">4</span>);</span><br><span class="line">ilevel.beacons = beacons; </span><br><span class="line"><span class="comment">% generamos una trayectoria dentro de este nivel </span></span><br><span class="line">x = <span class="number">10</span>:<span class="number">0.1</span>:<span class="number">40</span>;</span><br><span class="line">y = x + <span class="number">5</span>*<span class="built_in">sin</span>(x);</span><br><span class="line">itraj = mat2traj([x<span class="string">' y'</span>]);</span><br><span class="line"><span class="comment">% agregamos velocidad a itraj</span></span><br><span class="line">itraj = velocity(itraj);</span><br><span class="line"><span class="comment">% veamos la trayectoria en el nivel</span></span><br><span class="line">plot(ilevel)</span><br><span class="line">hold on</span><br><span class="line">plot(itraj)</span><br></pre></td></tr></table></figure>
<p><img src="/images/CT03/S02/0201.png" alt=" itraj y ilevel "></p>
<p>Existe tres tipo de señales. RSS, AoA o ToF. Si asignamos otro valor al parámetro de entrada <em>type</em>, saltará un error.<br><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BBSLevel(itraj,ilevel,<span class="string">'other'</span>)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">Error</span> <span class="string">using</span> <span class="string">type_BBS_valid</span> <span class="string">(line</span> <span class="number">7</span><span class="string">)</span></span><br><span class="line"><span class="string">The</span> <span class="string">"type"</span> <span class="string">parameter</span>  <span class="string">only</span> <span class="string">can</span> <span class="string">be</span> <span class="string">RSS,</span> <span class="string">ToF</span> <span class="string">or</span> <span class="string">AoA</span></span><br><span class="line"><span class="string">Error</span> <span class="string">in</span> <span class="string">BBSLevel</span> <span class="string">(line</span> <span class="number">42</span><span class="string">)</span></span><br><span class="line">            <span class="string">type_BBS_valid(type);</span></span><br></pre></td></tr></table></figure>
<p>Empezemos a ver las distintas opciones.</p>
<hr>
<hr>
<h2 id="Senal-RSS"><a href="#Senal-RSS" class="headerlink" title="Señal RSS"></a>Señal RSS</h2><p>Cuando el valor de <em>type</em>=’RSS’, se selecciona la función por defecto <em>RSS_dflt</em></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">type @RSS_dflt</span><br></pre></td></tr></table></figure>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">result</span> = <span class="title">RSS_dflt</span><span class="params">(index_beacon,index_node,ilevel,itraj,parameters)</span></span></span><br><span class="line"></span><br><span class="line">    <span class="comment">%% Parameters </span></span><br><span class="line">    sigma =  parameters(<span class="number">1</span>);</span><br><span class="line">    <span class="comment">%% Init</span></span><br><span class="line">    ibeacon = ilevel.beacons(index_beacon);</span><br><span class="line">    inode = itraj.nodes(index_node);</span><br><span class="line">    distance = distn(ibeacon,inode);</span><br><span class="line">    result = <span class="number">10</span>*<span class="built_in">log10</span>(distance) + normrnd(<span class="number">0</span>,sigma);</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>Esta función es la responsable de generar los valores de atenuación. Dado el índice de <em>beacon</em> dentro del objeto <em>level</em>, el indice de <em>node</em> dentro del objeto <em>traj</em>, ademas del propio nivel y la propia trayectoria podemos generar un valor de atenuación asociado a estos parámetros. Por otro lado, el parámetro <em>parameters</em>, en el caso de la función por defecto <em>RSS_dflt</em>; es un único número que simboliza la desviación estandar de un ruido gaussiano. </p>
<p>Entonces para crear la seña RSS, escribiremos:</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RSS_signal = BBSLevel(itraj,ilevel,<span class="string">'RSS'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">RSS_signal</span> <span class="string">=</span> </span><br><span class="line"></span><br><span class="line">  <span class="string">BBSLevel</span> <span class="string">with</span> <span class="attr">properties:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">              ms:</span> <span class="string">[1×281</span> <span class="string">ms_node]</span></span><br><span class="line"><span class="attr">    sgn_function:</span> <span class="string">@RSS_dflt</span></span><br><span class="line"><span class="attr">         beacons:</span> <span class="string">[1×4</span> <span class="string">beacon]</span></span><br><span class="line"><span class="attr">           label:</span> <span class="string">'RSS Signal'</span></span><br><span class="line"><span class="attr">            type:</span> <span class="string">'RSS'</span></span><br><span class="line"><span class="attr">              dt:</span> <span class="number">0.1000</span></span><br><span class="line"><span class="attr">       NumMaxAps:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">       direction:</span> <span class="string">'none'</span></span><br><span class="line"><span class="attr">         orderby:</span> <span class="string">'none'</span></span><br><span class="line"><span class="attr">             len:</span> <span class="number">281</span></span><br></pre></td></tr></table></figure>
<p>Visualizamos la atenuación de los distintos <em>beacons</em> frente al tiempo.<br><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">clf</span><br><span class="line">tbl_RSS = signal2table(RSS_signal);</span><br><span class="line"></span><br><span class="line">plot(tbl_RSS&#123;:,<span class="number">1</span>&#125;,tbl_RSS&#123;:,<span class="number">2</span>:<span class="number">5</span>&#125;)</span><br><span class="line">xlabel(<span class="string">'time'</span>)</span><br><span class="line">ylabel(<span class="string">'attenuation'</span>)</span><br><span class="line">title(<span class="string">'RSS Signal'</span>)</span><br><span class="line">legend(strcat(<span class="string">'beacon-'</span>,num2str((<span class="number">1</span>:<span class="number">4</span>)',<span class="string">'%0.2d'</span>)))</span><br></pre></td></tr></table></figure></p>
<p><img src="/images/CT03/S02/0202.png" alt="Señal RSS"></p>
<p>Si modificamos <em>parameters_sgn</em><br><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RSS_signal = BBSLevel(itraj,ilevel,<span class="string">'RSS'</span>,<span class="string">'parameters_sgn'</span>,<span class="number">0.01</span>)</span><br></pre></td></tr></table></figure></p>
<p>Entonces,<br><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">clf</span><br><span class="line">tbl_RSS = signal2table(RSS_signal);</span><br><span class="line"></span><br><span class="line">plot(tbl_RSS&#123;:,<span class="number">1</span>&#125;,tbl_RSS&#123;:,<span class="number">2</span>:<span class="number">5</span>&#125;)</span><br><span class="line">xlabel(<span class="string">'time'</span>); ylabel(<span class="string">'attenuation'</span>); title(<span class="string">'RSS Signal'</span>)</span><br><span class="line">legend(strcat(<span class="string">'beacon-'</span>,num2str((<span class="number">1</span>:<span class="number">4</span>)',<span class="string">'%0.2d'</span>)))</span><br></pre></td></tr></table></figure></p>
<p><img src="/images/CT03/S02/0202b.png" alt="Señal RSS"><br>Podemos ver que hemos reducido drásticamente el ruido de la señal</p>
<hr>
<hr>
<h2 id="Senal-AoA"><a href="#Senal-AoA" class="headerlink" title="Señal AoA"></a>Señal AoA</h2><p>De la misma manera para la opción ‘AoA’, tenemos una función por defecto llamada <em>AoA_dflt</em>.<br><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">type AoA_dflt</span><br></pre></td></tr></table></figure></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">result</span> = <span class="title">AoA_dflt</span><span class="params">(index_beacon,index_node,ilevel,itraj,parameters)</span></span></span><br><span class="line">    <span class="comment">%% Parameters </span></span><br><span class="line">    sigma =  parameters(<span class="number">1</span>);</span><br><span class="line">    <span class="comment">%% Init</span></span><br><span class="line">    ibeacon = ilevel.beacons(index_beacon);</span><br><span class="line">    inode = itraj.nodes(index_node);</span><br><span class="line">    <span class="comment">%</span></span><br><span class="line">    itheta = itraj.angles(index_node);</span><br><span class="line">    R =[ cos(itheta) -sin(itheta) ; sin(itheta) cos(itheta)];</span><br><span class="line">    result = atan_2pi((ibeacon.r-inode.r)*R) + normrnd(<span class="number">0</span>,sigma);</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>El ángulo de llegada se obtiene suponiendo que el sistema de referencia del dispositivo tiene como ángulo cero la tangente al recorrido. Es decir, el receptor siempre ‘mira’ hacia delante en todo el recorrido. De la misma forma que en la señal RSS, <em>parameters</em> es la desviación de un ruido gaussiano.</p>
<p>Creamos la señal:</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AoA_signal = BBSLevel(itraj,ilevel,<span class="string">'AoA'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">AoA_signal</span> <span class="string">=</span> </span><br><span class="line"></span><br><span class="line">  <span class="string">BBSLevel</span> <span class="string">with</span> <span class="attr">properties:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">              ms:</span> <span class="string">[1×272</span> <span class="string">ms_node]</span></span><br><span class="line"><span class="attr">    sgn_function:</span> <span class="string">@AoA_dflt</span></span><br><span class="line"><span class="attr">         beacons:</span> <span class="string">[1×4</span> <span class="string">beacon]</span></span><br><span class="line"><span class="attr">           label:</span> <span class="string">'AoA Signal'</span></span><br><span class="line"><span class="attr">            type:</span> <span class="string">'AoA'</span></span><br><span class="line"><span class="attr">              dt:</span> <span class="number">0.1000</span></span><br><span class="line"><span class="attr">       NumMaxAps:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">       direction:</span> <span class="string">'none'</span></span><br><span class="line"><span class="attr">         orderby:</span> <span class="string">'none'</span></span><br><span class="line"><span class="attr">             len:</span> <span class="number">272</span></span><br></pre></td></tr></table></figure>
<p>Visualizamos el ángulo de llegada de los distintos <em>beacons</em> frente al tiempo.</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">clf</span><br><span class="line">tbl_AoA = signal2table(AoA_signal);</span><br><span class="line"></span><br><span class="line">plot(tbl_AoA&#123;:,<span class="number">1</span>&#125;,tbl_AoA&#123;:,<span class="number">2</span>:<span class="number">5</span>&#125;)</span><br><span class="line">xlabel(<span class="string">'time'</span>)</span><br><span class="line">ylabel(<span class="string">'Angle of Arrive'</span>)</span><br><span class="line">title(<span class="string">'AoA Signal'</span>)</span><br><span class="line">legend(strcat(<span class="string">'beacon-'</span>,num2str((<span class="number">1</span>:<span class="number">4</span>)',<span class="string">'%0.2d'</span>)))</span><br></pre></td></tr></table></figure>
<p><img src="/images/CT03/S02/0203.png" alt="Señal AoA"></p>
<p>Si modificamos <em>parameters_sgn</em><br><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AoA_signal = BBSLevel(itraj,ilevel,<span class="string">'AoA'</span>,<span class="string">'parameters_sgn'</span>,<span class="number">0.01</span>)</span><br></pre></td></tr></table></figure></p>
<p>Entonces<br><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">clf</span><br><span class="line">tbl_AoA = signal2table(AoA_signal);</span><br><span class="line"></span><br><span class="line">plot(tbl_AoA&#123;:,<span class="number">1</span>&#125;,tbl_AoA&#123;:,<span class="number">2</span>:<span class="number">5</span>&#125;)</span><br><span class="line">xlabel(<span class="string">'time'</span>)</span><br><span class="line">ylabel(<span class="string">'Angle of Arrive'</span>)</span><br><span class="line">title(<span class="string">'AoA Signal'</span>)</span><br><span class="line">legend(strcat(<span class="string">'beacon-'</span>,num2str((<span class="number">1</span>:<span class="number">4</span>)',<span class="string">'%0.2d'</span>)))</span><br></pre></td></tr></table></figure></p>
<p><img src="/images/CT03/S02/0203b.png" alt="Señal AoA"><br>Podemos ver que hemos reducido drásticamente el ruido de la señal</p>
<hr>
<hr>
<h2 id="Senal-ToF"><a href="#Senal-ToF" class="headerlink" title="Señal ToF"></a>Señal ToF</h2><p>Para la opción ‘ToF’, tenemos más de lo mismo.<br><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">type ToF_dflt</span><br></pre></td></tr></table></figure></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">result</span> = <span class="title">ToF_dflt</span><span class="params">(index_beacon,index_node,ilevel,itraj,parameters)</span></span></span><br><span class="line">    <span class="comment">%% Constants </span></span><br><span class="line">    c = <span class="number">3e8</span>;    </span><br><span class="line">    <span class="comment">%% Parameters </span></span><br><span class="line">    sigma =  parameters(<span class="number">1</span>);</span><br><span class="line">    <span class="comment">%% Init</span></span><br><span class="line">    ibeacon = ilevel.beacons(index_beacon);</span><br><span class="line">    inode = itraj.nodes(index_node);</span><br><span class="line">    <span class="comment">%</span></span><br><span class="line">    distance = distn(ibeacon,inode);</span><br><span class="line">    result = distance/c + normrnd(<span class="number">0</span>,sigma);</span><br></pre></td></tr></table></figure>
<p>Como vemos esta función simplemente cálcula la distancia entre el <em>nodo (index_node)</em> y el <em>beacon (index_beacon)</em> y lo divide entre la velocidad de la luz. Igual que antes la variable  <em>parameters</em> es la desviación por ruido gaussiano.</p>
<p>Creamos la señal,</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ToF_signal = BBSLevel(itraj,ilevel,<span class="string">'ToF'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">ToF_signal</span> <span class="string">=</span> </span><br><span class="line"></span><br><span class="line">  <span class="string">BBSLevel</span> <span class="string">with</span> <span class="attr">properties:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">              ms:</span> <span class="string">[1×272</span> <span class="string">ms_node]</span></span><br><span class="line"><span class="attr">    sgn_function:</span> <span class="string">@ToF_dflt</span></span><br><span class="line"><span class="attr">         beacons:</span> <span class="string">[1×4</span> <span class="string">beacon]</span></span><br><span class="line"><span class="attr">           label:</span> <span class="string">'ToF Signal'</span></span><br><span class="line"><span class="attr">            type:</span> <span class="string">'ToF'</span></span><br><span class="line"><span class="attr">              dt:</span> <span class="number">0.1000</span></span><br><span class="line"><span class="attr">       NumMaxAps:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">       direction:</span> <span class="string">'none'</span></span><br><span class="line"><span class="attr">         orderby:</span> <span class="string">'none'</span></span><br><span class="line"><span class="attr">             len:</span> <span class="number">272</span></span><br></pre></td></tr></table></figure>
<p>Visualizamos la atenuación de los distintos <em>beacons</em> frente al tiempo.</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">clf</span><br><span class="line">tbl_ToF = signal2table(ToF_signal);</span><br><span class="line"></span><br><span class="line">plot(tbl_ToF&#123;:,<span class="number">1</span>&#125;,tbl_ToF&#123;:,<span class="number">2</span>:<span class="number">5</span>&#125;)</span><br><span class="line">xlabel(<span class="string">'time'</span>)</span><br><span class="line">ylabel(<span class="string">'Time of flight'</span>)</span><br><span class="line">title(<span class="string">'ToF Signal'</span>)</span><br><span class="line">legend(strcat(<span class="string">'beacon-'</span>,num2str((<span class="number">1</span>:<span class="number">4</span>)',<span class="string">'%0.2d'</span>)))</span><br></pre></td></tr></table></figure>
<p><img src="/images/CT03/S02/0204.png" alt="Señal ToF"></p>
<p>Si modificamos <em>parameters_sgn</em><br><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ToF_signal = BBSLevel(itraj,ilevel,<span class="string">'ToF'</span>,<span class="string">'parameters_sgn'</span>,<span class="number">0.00</span>)</span><br></pre></td></tr></table></figure></p>
<p>Entonces<br><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">clf</span><br><span class="line">tbl_ToF = signal2table(ToF_signal);</span><br><span class="line"></span><br><span class="line">plot(tbl_ToF&#123;:,<span class="number">1</span>&#125;,tbl_ToF&#123;:,<span class="number">2</span>:<span class="number">5</span>&#125;)</span><br><span class="line">xlabel(<span class="string">'time'</span>)</span><br><span class="line">ylabel(<span class="string">'Time of flight'</span>)</span><br><span class="line">title(<span class="string">'ToF Signal'</span>)</span><br><span class="line">legend(strcat(<span class="string">'beacon-'</span>,num2str((<span class="number">1</span>:<span class="number">4</span>)',<span class="string">'%0.2d'</span>)))</span><br></pre></td></tr></table></figure></p>
<p><img src="/images/CT03/S02/0204b.png" alt="Señal AoA"><br>Podemos ver que hemos reducido drásticamente el ruido de la señal</p>
<hr>
<hr>
<h5 id="Funcciones-utilizadas"><a href="#Funcciones-utilizadas" class="headerlink" title="Funcciones utilizadas"></a>Funcciones utilizadas</h5><ul>
<li>level/rand</li>
<li>mat2traj</li>
</ul>
<hr>
<h5 id="Otras-clases-utilizadas"><a href="#Otras-clases-utilizadas" class="headerlink" title="Otras clases utilizadas"></a>Otras clases utilizadas</h5><ul>
<li>level</li>
<li>traj</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/CT03_S02_T02/" data-id="cjgs25pxn000ee5s4zx6j1dp6" class="article-share-link">Compartir</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ejemplos/">ejemplos</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/CT03_S02_T03/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Nuevo</strong>
      <div class="article-nav-title">
        
          T03 Parámetro sgn_function. Simulación de RSS a medida.
        
      </div>
    </a>
  
  
    <a href="/CT02_S02_T02/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Viejo</strong>
      <div class="article-nav-title">Clase traj</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categorías</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CT01-Planimetria/">CT01 Planimetría</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/CT01-Planimetria/S01-Introduccion/">S01 Introducción</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/CT02-Simulacion-de-trayectorias/">CT02 Simulación de trayectorias</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/CT02-Simulacion-de-trayectorias/S01-Introducion/">S01 Introdución</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CT02-Simulacion-de-trayectorias/S02-Clase-traj/">S02 Clase traj</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CT02-Simulacion-de-trayectorias/S03-Clase-supertraj/">S03 Clase supertraj</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/CT03-Simulacion-de-senales/">CT03 Simulación de señales</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/CT03-Simulacion-de-senales/S01-Introduccion/">S01 Introducción</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CT03-Simulacion-de-senales/S02-Clase-BBSLevel/">S02 Clase BBSLevel</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CT03-Simulacion-de-senales/S03-Clase-BFSLevel/">S03 Clase BFSLevel</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CT03-Simulacion-de-senales/S04-Clase-BeaconBasedSgn/">S04 Clase BeaconBasedSgn</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CT03-Simulacion-de-senales/S05-Clase-BeaconFreeSgn/">S05 Clase BeaconFreeSgn</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/CT04-Procesamiento-de-senales/">CT04 Procesamiento de señales</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/CT04-Procesamiento-de-senales/S01-Introduccion/">S01 Introducción</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/CT05-Comparacion-de-metodos/">CT05 Comparación de métodos</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/CT05-Comparacion-de-metodos/S01-Introduccion/">S01 Introducción</a></li></ul></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 Jesus Oroya<br>
      Construido por <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="https://github.com/joroya/navindoor" class="mobile-nav-link">GitHub</a>
  
    <a href="/" class="mobile-nav-link">Download</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>